# Traffic Tracker

Система трекинга трафика с использованием YOLO для обнаружения транспортных средств и отслеживания их пересечения с заданной линией.

## Структура проекта

```
TestCV/
├── main.py                 # Главный модуль приложения
├── config.py              # Конфигурационные параметры
├── requirements.txt       # Зависимости проекта
├── README.md             # Документация
├── utils/                # Утилиты
│   ├── __init__.py
│   ├── geometry.py       # Геометрические вычисления
│   └── logger.py         # Настройка логирования
├── tracker/              # Модули трекинга
│   ├── __init__.py
│   └── traffic_tracker.py # Основной класс трекера
├── examples/             # Примеры использования
│   └── example_usage.py
├── logs/                 # Папка с логами (создается автоматически)
├── yolov8s.pt           # Модель YOLO
└── cvtest.avi           # Тестовое видео
```

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Убедитесь, что у вас есть модель YOLO (`yolov8s.pt`) в корневой директории проекта.

## Использование

Запустите приложение:
```bash
python main.py
```

### Функциональность

- **Обнаружение объектов**: Использует YOLO для обнаружения автомобилей, мотоциклов и грузовиков
- **Интерактивная настройка**: Позволяет пользователю задать линию интереса кликами мыши
- **Отслеживание пересечений**: Определяет, когда объекты пересекают заданную линию
- **Визуализация**: Отображает результаты в реальном времени
- **Логирование**: Ведет подробные логи в папку `logs/traffic_tracker.log`

### Управление

- **Настройка линии**: Кликните мышью в двух точках для задания линии интереса
- **Выход**: Нажмите 'q' для завершения работы
- **Отмена настройки**: Нажмите 'q' во время настройки линии

## Конфигурация

Основные параметры можно изменить в файле `config.py`:

- `TARGET_CLASSES`: Классы объектов для отслеживания
- `DISPLAY_WIDTH/HEIGHT`: Размер окна отображения
- `YOLO_CONFIDENCE`: Порог уверенности для детекции
- `LOG_LEVEL`: Уровень логирования
- `LOG_DIR`: Папка для сохранения логов

## API

### TrafficTracker

Основной класс для трекинга трафика.

```python
from tracker.traffic_tracker import TrafficTracker

# Создание трекера
tracker = TrafficTracker("path/to/video.mp4")

# Запуск трекинга
tracker.run()

# Получение статуса (потокобезопасно)
status = tracker.get_object_on_line_status()

# Остановка трекинга
tracker.stop()
```

### Методы

- `get_object_on_line_status()`: Возвращает текущий статус наличия объекта на линии
- `run()`: Запускает основной цикл трекинга
- `stop()`: Останавливает трекинг

## Логирование

Приложение ведет логи в папку `logs/traffic_tracker.log` и выводит их в консоль. Папка `logs` создается автоматически при первом запуске. Уровни логирования:

- `INFO`: Основная информация о работе
- `ERROR`: Ошибки и исключения
- `DEBUG`: Детальная отладочная информация

## Требования

- Python 3.8+
- OpenCV
- Ultralytics YOLO
- PyTorch
- CUDA (опционально, для ускорения GPU) 